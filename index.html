<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Banking Dashboard — Runank</title>

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">

  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">

  <style>
    body {
      font-family: 'Inter', sans-serif;
      background: linear-gradient(135deg,#0f2027,#203a43,#2c5364);
      color: #f0f3f7;
      padding-top: 2rem;
      transition: all 0.5s ease;
    }
    body.light {
      background: #f5f7fa;
      color: #1c2430;
    }
    .card {
      background: rgba(255,255,255,0.08);
      border: none;
      border-radius: 20px;
      box-shadow: 0 12px 25px rgba(0,0,0,0.4);
      transition: transform 0.3s, box-shadow 0.3s, background 0.3s;
    }
    body.light .card {
      background: #fff;
      color: #1c2430;
      box-shadow: 0 10px 20px rgba(0,0,0,0.1);
    }
    .card:hover {
      transform: translateY(-5px);
      box-shadow: 0 15px 35px rgba(0,0,0,0.5);
    }
    .btn-primary {
      background: linear-gradient(90deg,#6ee7b7,#3b82f6);
      border: none;
      color: #fff;
      font-weight: 600;
      transition: transform 0.3s, box-shadow 0.3s;
    }
    .btn-primary:hover {
      transform: translateY(-3px) scale(1.05);
      box-shadow: 0 8px 20px rgba(0,0,0,0.3);
    }
    .btn-outline-dark {
      border-radius: 12px;
      transition: transform 0.3s, box-shadow 0.3s;
    }
    .btn-outline-dark:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(0,0,0,0.2);
    }
    .balance-number {
      font-size: 2rem;
      font-weight: 700;
      background: linear-gradient(90deg,#6ee7b7,#3b82f6);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      animation: fadeInBalance 1s ease-in-out;
    }
    @keyframes fadeInBalance {
      0% { opacity: 0; transform: translateY(20px);}
      100% { opacity: 1; transform: translateY(0);}
    }
    .mode-toggle { cursor:pointer; font-size: 0.9rem; transition: color 0.3s; }
    .mode-toggle:hover { color: #6ee7b7; }

    /* History Table */
    .history-table {
      font-size: 0.9rem;
      color: #e0e0e0;
    }
    .history-table tbody tr {
      transition: transform 0.3s, background 0.3s;
      cursor: default;
    }
    .history-table tbody tr:hover {
      transform: translateX(5px);
      background: rgba(255,255,255,0.1);
    }

    /* Smooth fade-in */
    .fade-in { animation: fadeIn 0.5s ease-in; }
    @keyframes fadeIn { from {opacity:0; transform:translateY(8px);} to {opacity:1; transform:translateY(0);} }

    input.form-control {
      border-radius: 12px;
      transition: box-shadow 0.3s;
    }
    input.form-control:focus {
      box-shadow: 0 0 12px rgba(52, 211, 153, 0.5);
      border-color: #34d399;
    }
  </style>
</head>
<body>
  <main class="container" style="max-width:960px">
    <!-- Header -->
    <div class="d-flex justify-content-between align-items-center mb-4">
      <h1><i class="bi bi-bank2"></i> Banking Dashboard — Runank</h1>
      <div class="mode-toggle text-muted"><i class="bi bi-moon-stars-fill"></i> Toggle Mode</div>
    </div>

    <!-- Controls & Balance -->
    <div class="row g-4">
      <div class="col-md-6">
        <div class="card p-4">
          <h5><i class="bi bi-wallet2"></i> Actions</h5>
          <div class="mb-3 mt-3">
            <label class="form-label">Deposit Amount</label>
            <input id="depositAmt" type="number" class="form-control" placeholder="Enter amount (e.g., 500)">
            <button id="depositBtn" class="btn btn-primary mt-3 w-100">Deposit</button>
          </div>
          <div class="mb-3">
            <label class="form-label">Withdraw Amount</label>
            <input id="withdrawAmt" type="number" class="form-control" placeholder="Enter amount (e.g., 200)">
            <button id="withdrawBtn" class="btn btn-outline-dark mt-3 w-100">Withdraw</button>
          </div>
          <div class="d-flex gap-2 mt-3">
            <button id="checkBtn" class="btn btn-info text-dark w-50">Check Balance</button>
            <button id="resetBtn" class="btn btn-danger w-50">Reset</button>
          </div>
        </div>
      </div>

      <div class="col-md-6">
        <div class="card p-4 text-center">
          <h5><i class="bi bi-cash-stack"></i> Current Balance</h5>
          <div id="balanceDisplay" class="balance-number">0</div>
          <small class="muted">Balance persists in your browser</small>
        </div>
      </div>
    </div>

    <!-- Transaction history -->
    <div class="card p-3 mt-4">
      <h5><i class="bi bi-journal-text"></i> Transaction History</h5>
      <div style="max-height:250px; overflow-y:auto;">
        <table class="table table-sm table-hover history-table">
          <thead>
            <tr><th>#</th><th>Type</th><th>Amount</th><th>Balance After</th><th>Time</th></tr>
          </thead>
          <tbody id="historyBody"></tbody>
        </table>
      </div>
    </div>
  </main>

  <!-- Pyodide -->
  <script src="https://cdn.jsdelivr.net/pyodide/v0.23.4/full/pyodide.js"></script>
  <script>
    let pyodide = null;
    let historyCount = 0;

    async function initPy() {
      pyodide = await loadPyodide({ indexURL: "https://cdn.jsdelivr.net/pyodide/v0.23.4/full/" });
      const code = `
balance = 0
def check_balance(): return balance
def cash_withdraw(w_amt):
    global balance
    w_amt = int(w_amt)
    if w_amt <= 0: return "Enter >0"
    if balance < w_amt: return "Insufficient"
    balance -= w_amt
    return f"Withdrew {w_amt}"
def cash_deposit(d_amt):
    global balance
    d_amt = int(d_amt)
    if d_amt <= 0: return "Enter >0"
    balance += d_amt
    return f"Deposited {d_amt}"
`;
      await pyodide.runPythonAsync(code);

      const stored = localStorage.getItem('balance');
      if (stored) pyodide.runPython(`balance = ${stored}`);
      updateBalance();
    }
    initPy();

    function updateBalance(){
      const bal = pyodide.runPython('balance');
      document.getElementById('balanceDisplay').textContent = bal;
      localStorage.setItem('balance', bal);
    }

    function addHistory(type, amt){
      historyCount++;
      const bal = pyodide.runPython('balance');
      const row = document.createElement('tr');
      row.classList.add('fade-in');
      row.innerHTML = `<td>${historyCount}</td>
        <td>${type}</td>
        <td>${amt}</td>
        <td>${bal}</td>
        <td>${new Date().toLocaleTimeString()}</td>`;
      document.getElementById('historyBody').prepend(row);
    }

    document.getElementById('depositBtn').addEventListener('click', async ()=>{
      const amt = document.getElementById('depositAmt').value;
      if(!amt || parseInt(amt)<=0){ alert("Enter valid deposit"); return; }
      await pyodide.runPythonAsync(`cash_deposit(${amt})`);
      updateBalance();
      addHistory("Deposit", amt);
      document.getElementById('depositAmt').value="";
    });

    document.getElementById('withdrawBtn').addEventListener('click', async ()=>{
      const amt = document.getElementById('withdrawAmt').value;
      if(!amt || parseInt(amt)<=0){ alert("Enter valid withdraw"); return; }
      const res = await pyodide.runPythonAsync(`cash_withdraw(${amt})`);
      if(res === "Insufficient"){ alert("Insufficient Balance"); return; }
      updateBalance();
      addHistory("Withdraw", amt);
      document.getElementById('withdrawAmt').value="";
    });

    document.getElementById('checkBtn').addEventListener('click', updateBalance);
    document.getElementById('resetBtn').addEventListener('click', async ()=>{
      await pyodide.runPythonAsync('balance = 0');
      updateBalance();
      addHistory("Reset",0);
    });

    document.querySelector('.mode-toggle').addEventListener('click',()=>{ document.body.classList.toggle('light'); });
  </script>
</body>
</html>
